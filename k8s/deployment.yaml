apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend-deployment
  labels:
    app: frontend
spec:
  replicas: 2
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
      - name: frontend
        image: 759743607521.dkr.ecr.us-east-1.amazonaws.com/frontend:latest
        ports:
        - containerPort: 80
        env:
        - name: REACT_APP_API_URL
          value: http://a2016a4ac757b4658ae03524415d0ee8-1094018300.us-east-1.elb.amazonaws.com:8080/

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-deployment
  labels:
    app: backend
spec:
  replicas: 2
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      labels:
        app: backend
    spec:
      containers:
      - name: backend
        image: 759743607521.dkr.ecr.us-east-1.amazonaws.com/backend:latest
        ports:
        - containerPort: 8080
        env:
        - name: DATABASE_URL
          value: "mysql+pymysql://root:password@db-service:3306/portfolio"
        - name: SECRET_KEY
          value: "7307537ac6d3eb66bd6a71a8582699972a0a67ad58dd086c9b6d87ca1a73f331d0eedf3cee4b18de4f688b0c647c6ee6d5eebcd9591da544fb45d3a61d438cbe5f35d7e1dd69cdf0356c51172f8af522ad57ebb053996bebe9b807e06280d2c9fe820611ecb1cdd29f3751296df4a17b8489bc08b62fdf2051e14898845f032d8d7c6ebbd2f7622bbd9c60821340969093972f460243b8ea5af0328a1b00a7e2bf826a9ab8eefc24b21b0d181ad3e5f7f4318af11c1d30431af903b29d410f05352ee2bca9fa2dd4d3957619164e8962da28d344a584e4f9847c68861234197c579cc77179b2863b084134dc5bff4a90dcf15485ac0e04b7fc291717abf534a3"
        - name: DEBUG
          value: "true"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mysql-deployment
  labels:
    app: mysql
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      - name: mysql
        image: mysql:8.0
        ports:
        - containerPort: 3306
        env:
        - name: MYSQL_ROOT_PASSWORD
          value: "password"
        - name: MYSQL_DATABASE
          value: "portfolio"
        volumeMounts:
        - name: mysql-data
          mountPath: /var/lib/mysql
      volumes:
      - name: mysql-data
        emptyDir: {}

